# ============================================================
# ENVIRONMENT VARIABLES - TECH4LOOP
# ============================================================
# Copy this file to .env.local and fill in your actual values
# DO NOT commit .env.local to git (it contains secrets)
# ============================================================

# ============================================================
# STRIPE CONFIGURATION
# ============================================================
# Get these from https://dashboard.stripe.com/apikeys
# Test mode: Keys starting with "pk_test_" and "sk_test_"
# Production mode: Keys starting with "pk_live_" and "sk_live_" (after go-live)

# Publishable key (can be public, used in frontend)
NEXT_PUBLIC_STRIPE_PUBLIC_KEY=pk_test_YOUR_PUBLISHABLE_KEY_HERE

# Secret key (NEVER share, only on backend)
STRIPE_SECRET_KEY=sk_test_YOUR_SECRET_KEY_HERE

# Webhook secret for verifying Stripe events
# Get from https://dashboard.stripe.com/webhooks after setting up endpoint
STRIPE_WEBHOOK_SECRET=whsec_YOUR_WEBHOOK_SECRET_HERE

# ============================================================
# RESEND EMAIL CONFIGURATION
# ============================================================
# Get this from https://resend.com/api-keys
# Free plan: Up to 100 emails/day

RESEND_API_KEY=re_YOUR_API_KEY_HERE

# Email address that sends transactional emails
# Must be from your verified domain or resend.dev for testing
NEXT_PUBLIC_APP_EMAIL=noreply@tech4loop.com

# Support email for customer inquiries
NEXT_PUBLIC_SUPPORT_EMAIL=support@tech4loop.com

# ============================================================
# SUPABASE CONFIGURATION
# ============================================================
# Get these from https://supabase.com/dashboard/project/[project-id]/settings/api
# These connect your app to the PostgreSQL database

# Your Supabase project URL
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co

# Anon key (can be public, used in frontend for auth/queries)
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Service role key (NEVER share, only on backend for admin operations)
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# ============================================================
# APPLICATION CONFIGURATION
# ============================================================

# Your app URL (used in verification links, emails, etc)
# Development: http://localhost:3000
# Production: https://tech4loop.com (or your domain)
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Next.js environment
NODE_ENV=development

# ============================================================
# OPTIONAL: ANALYTICS & MONITORING
# ============================================================
# Sentry for error tracking (optional)
# NEXT_PUBLIC_SENTRY_DSN=https://...

# Google Analytics (optional)
# NEXT_PUBLIC_GA_ID=G-...

# ============================================================
# OPTIONAL: PAYMENT GATEWAYS (Future)
# ============================================================
# PayPal (for future implementation)
# PAYPAL_CLIENT_ID=...
# PAYPAL_SECRET=...

# PIX Integration (for future implementation)
# PIX_API_KEY=...

# ============================================================
# OPTIONAL: TRACKING/SHIPPING (Future)
# ============================================================
# Melhor Envio API
# MELHOR_ENVIO_API_KEY=...
# MELHOR_ENVIO_API_SECRET=...

# Loggi Integration
# LOGGI_API_KEY=...

# ============================================================
# HOW TO GET EACH SECRET
# ============================================================

# 1. STRIPE_PUBLIC_KEY & STRIPE_SECRET_KEY
#    Step 1: Go to https://dashboard.stripe.com/apikeys
#    Step 2: Copy "Publishable key" and "Secret key" from Test mode
#    Step 3: In .env.local, replace YOUR_PUBLISHABLE_KEY_HERE and YOUR_SECRET_KEY_HERE
#
#    Example:
#    NEXT_PUBLIC_STRIPE_PUBLIC_KEY=pk_test_51234567890abcdef
#    STRIPE_SECRET_KEY=sk_test_abcdef1234567890

# 2. STRIPE_WEBHOOK_SECRET
#    Step 1: Go to https://dashboard.stripe.com/webhooks
#    Step 2: Click "Add endpoint"
#    Step 3: Enter URL: https://yoursite.com/api/payments/stripe-webhook
#    Step 4: Select events: payment_intent.succeeded, payment_intent.payment_failed, charge.refunded
#    Step 5: Copy the "Signing secret" (starts with whsec_)
#    Step 6: Add to .env.local
#
#    For local testing with Stripe CLI:
#    $ stripe listen --forward-to localhost:3000/api/payments/stripe-webhook
#    Copy the webhook secret from the output

# 3. RESEND_API_KEY
#    Step 1: Go to https://resend.com/api-keys
#    Step 2: Click "Create API Key"
#    Step 3: Copy the key (starts with re_)
#    Step 4: Add to .env.local

# 4. SUPABASE_URL & KEYS
#    Step 1: Go to https://supabase.com/dashboard
#    Step 2: Select your project
#    Step 3: Go to Settings → API
#    Step 4: Copy "Project URL" and "anon public" key
#    Step 5: For service role key, go to Settings → API → Service role key
#    Step 6: Add all three to .env.local

# ============================================================
# TESTING PAYMENT CARDS
# ============================================================
# Use these test cards with Stripe in test mode
# (Replace with these in your checkout form)

# Successful payment
# Card: 4242 4242 4242 4242
# Exp: Any future date (e.g., 12/25)
# CVC: Any 3 digits (e.g., 123)

# Declined card
# Card: 4000 0000 0000 0002
# Exp: Any future date
# CVC: Any 3 digits

# Requires authentication
# Card: 4000 0025 0000 3155
# Exp: Any future date
# CVC: Any 3 digits

# ============================================================
# TESTING EMAIL
# ============================================================
# With Resend free plan, you can send to any email during trial
# After trial, set up your domain to send from your own email

# Test email sending:
# 1. curl -X POST http://localhost:3000/api/emails/send \
#    -H "Content-Type: application/json" \
#    -d '{"type": "confirmation", "email": "test@example.com", "data": {}}'
# 2. Check your email (including spam folder)

# ============================================================
# VERIFICATION & SECURITY
# ============================================================
# After setting up .env.local, verify everything works:

# 1. Test Stripe connection
#    npm run test:stripe
#
# 2. Test Resend email
#    npm run test:email
#
# 3. Test Supabase connection
#    npm run test:supabase
#
# 4. Run all tests
#    npm test

# ============================================================
# PRODUCTION CHECKLIST
# ============================================================
# Before deploying to production:
# 
# [ ] Switch Stripe keys from test to live (pk_live_, sk_live_)
# [ ] Update STRIPE_WEBHOOK_SECRET with production endpoint
# [ ] Update RESEND_API_KEY if using different account
# [ ] Update NEXT_PUBLIC_APP_URL to production domain
# [ ] Update Supabase keys if using separate prod database
# [ ] Enable HTTPS on production domain
# [ ] Set NODE_ENV=production
# [ ] Add all secrets to your hosting platform (Vercel, etc)
# [ ] Do NOT include .env.local in production deployment
# [ ] Test payment flow with real cards in production
# [ ] Verify webhook receiving events

# ============================================================
# TROUBLESHOOTING
# ============================================================

# Error: "Stripe API key not set"
# Solution: Ensure STRIPE_SECRET_KEY is in .env.local and starts with sk_test_ or sk_live_

# Error: "Email not sending"
# Solution: Check RESEND_API_KEY is correct and email is in allowed list

# Error: "Webhook signature verification failed"
# Solution: Ensure STRIPE_WEBHOOK_SECRET matches the one from Stripe dashboard

# Error: "Could not connect to Supabase"
# Solution: Verify NEXT_PUBLIC_SUPABASE_URL and SUPABASE_SERVICE_ROLE_KEY are correct

# ============================================================
